# CSV-Word转换工具部署指南

## 项目概述

CSV-Word转换工具是一个专业的Python包，用于将CSV数据转换为格式化的Word文档。支持多种模板和自定义配置，适用于各种业务场景。

## 系统要求

- **Python版本**: 3.8 或更高版本
- **操作系统**: Windows, macOS, Linux
- **内存**: 建议至少 2GB RAM
- **磁盘空间**: 至少 500MB 可用空间

## 部署方式

### 1. 开发环境部署

#### 1.1 克隆项目
```bash
git clone <repository-url>
cd clientab-main
```

#### 1.2 创建虚拟环境
```bash
# Windows
python -m venv .venv
.\.venv\Scripts\Activate.ps1

# macOS/Linux
python -m venv .venv
source .venv/bin/activate
```

#### 1.3 安装依赖
```bash
pip install -r requirements.txt
```

#### 1.4 验证安装
```bash
python -m csv_word_converter --version
```

### 2. 生产环境部署

#### 2.1 使用pip安装（推荐）
```bash
# 从本地源码安装
pip install .

# 或者使用开发模式安装
pip install -e .
```

#### 2.2 Docker部署
```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .
RUN pip install .

CMD ["python", "-m", "csv_word_converter", "--help"]
```

#### 2.3 系统服务部署
创建systemd服务文件（Linux）：
```ini
[Unit]
Description=CSV-Word Converter Service
After=network.target

[Service]
Type=simple
User=csvword
WorkingDirectory=/opt/csv-word-converter
ExecStart=/opt/csv-word-converter/.venv/bin/python -m csv_word_converter
Restart=always

[Install]
WantedBy=multi-user.target
```

### 3. 云平台部署

#### 3.1 AWS Lambda部署
1. 创建Lambda函数
2. 上传代码包（包含依赖）
3. 配置环境变量
4. 设置触发器（S3、API Gateway等）

#### 3.2 Azure Functions部署
1. 创建Function App
2. 配置Python运行时
3. 部署代码
4. 配置绑定和触发器

#### 3.3 Google Cloud Functions部署
```bash
gcloud functions deploy csv-word-converter \
    --runtime python311 \
    --trigger-http \
    --allow-unauthenticated
```

## 配置管理

### 环境变量
```bash
# 可选配置
export CSV_WORD_LOG_LEVEL=INFO
export CSV_WORD_OUTPUT_DIR=/path/to/output
export CSV_WORD_TEMP_DIR=/path/to/temp
```

### 配置文件
创建 `config.yaml`:
```yaml
logging:
  level: INFO
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

output:
  default_dir: "./outputs"
  temp_dir: "./temp-data"

templates:
  default: "guoziwei"
  available:
    - guoziwei
    - new_energy
    - realty
    - technology
    - electricity
```

## 使用方法

### 命令行使用
```bash
# 基本转换
python -m csv_word_converter input.csv --template guoziwei

# 指定输出目录
python -m csv_word_converter input.csv --template technology --output-dir ./reports

# 静默模式
python -m csv_word_converter input.csv --template electricity --quiet

# 仅验证CSV文件
python -m csv_word_converter input.csv --validate-only

# 详细输出
python -m csv_word_converter input.csv --template realty --verbose
```

### Python API使用
```python
from csv_word_converter import csv_to_word_universal

# 基本使用
result = csv_to_word_universal(
    csv_file="data.csv",
    template_type="guoziwei",
    output_dir="./outputs"
)

print(f"生成的文档: {result}")
```

## 监控和日志

### 日志配置
```python
import logging

# 配置日志级别
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
```

### 性能监控
- 监控内存使用情况
- 跟踪文档生成时间
- 监控错误率和成功率

### 健康检查
```bash
# 检查服务状态
python -m csv_word_converter --version

# 验证模板可用性
python -m csv_word_converter --list-templates
```

## 故障排除

### 常见问题

1. **依赖缺失错误**
   ```bash
   pip install regex validators
   ```

2. **内存不足**
   - 增加系统内存
   - 分批处理大文件
   - 优化图片大小

3. **权限问题**
   ```bash
   chmod +x /path/to/csv_word_converter
   ```

4. **编码问题**
   - 确保CSV文件使用UTF-8编码
   - 检查系统区域设置

### 调试模式
```bash
python -m csv_word_converter input.csv --template guoziwei --verbose --debug
```

## 安全考虑

1. **输入验证**: 验证CSV文件格式和内容
2. **路径安全**: 防止路径遍历攻击
3. **资源限制**: 限制文件大小和处理时间
4. **权限控制**: 最小权限原则

## 性能优化

1. **并发处理**: 使用多进程处理大批量文件
2. **缓存机制**: 缓存模板和配置
3. **内存管理**: 及时释放不需要的对象
4. **I/O优化**: 使用异步I/O处理文件操作

## 备份和恢复

### 数据备份
- 定期备份输出文档
- 备份配置文件和模板
- 版本控制代码变更

### 灾难恢复
- 准备恢复脚本
- 测试恢复流程
- 文档化恢复步骤

## 版本升级

### 升级步骤
1. 备份当前版本
2. 测试新版本兼容性
3. 更新依赖包
4. 验证功能正常
5. 部署到生产环境

### 回滚计划
- 保留上一版本
- 准备回滚脚本
- 监控升级后状态

## 支持和维护

- **文档**: 查看项目文档和API参考
- **问题报告**: 通过GitHub Issues报告问题
- **社区支持**: 参与社区讨论
- **商业支持**: 联系开发团队获取专业支持

---

**最后更新**: 2025-09-20
**版本**: 1.0.0