# CSV-Word转换工具部署测试计划

## 测试目标

验证CSV-Word转换工具项目在不同环境下的部署可行性，确保：
1. 项目能够正确打包和分发
2. 在干净环境中能够成功安装
3. 所有核心功能在生产环境中正常工作
4. 依赖管理和版本兼容性符合预期

## 测试环境规格

### 基础环境要求
- **操作系统**: Windows 10/11 (主要), Linux Ubuntu 20.04+ (次要)
- **Python版本**: 3.8, 3.9, 3.10, 3.11, 3.12
- **内存**: 最小2GB，推荐4GB+
- **磁盘空间**: 最小500MB可用空间

### 测试环境类型
1. **开发环境**: 当前工作环境，用于基础功能验证
2. **干净环境**: 全新Python虚拟环境，模拟首次安装
3. **生产模拟环境**: 无开发工具的最小化环境

## 测试阶段与验收标准

### 阶段1: 项目打包构建测试

#### 测试内容
- [ ] 验证setup.py配置正确性
- [ ] 验证pyproject.toml配置完整性
- [ ] 测试源码分发包(sdist)构建
- [ ] 测试wheel包构建
- [ ] 验证包元数据信息

#### 验收标准
- ✅ `python setup.py sdist` 成功执行，无错误
- ✅ `python -m build` 成功生成wheel和tar.gz文件
- ✅ 生成的包文件大小合理(< 50MB)
- ✅ 包含所有必要的源码文件和配置
- ✅ 排除测试文件、临时文件和开发工具文件

#### 测试命令
```powershell
# 构建源码分发包
python setup.py sdist

# 构建wheel包
python -m build

# 检查包内容
python -m tarfile -l dist/csv-word-converter-1.0.0.tar.gz
python -m zipfile -l dist/csv_word_converter-1.0.0-py3-none-any.whl
```

### 阶段2: 干净环境安装测试

#### 测试内容
- [ ] 在新虚拟环境中安装项目
- [ ] 验证依赖自动安装
- [ ] 测试命令行工具可用性
- [ ] 验证核心功能正常

#### 验收标准
- ✅ `pip install dist/csv_word_converter-1.0.0-py3-none-any.whl` 成功
- ✅ 所有依赖包自动安装，无冲突
- ✅ `python -m csv_word_converter --help` 正常显示帮助
- ✅ 基础CSV转换功能正常工作
- ✅ 安装后包大小合理

#### 测试命令
```powershell
# 创建新的测试环境
python -m venv test_env
test_env\Scripts\Activate.ps1

# 安装构建的包
pip install dist/csv_word_converter-1.0.0-py3-none-any.whl

# 验证安装
python -m csv_word_converter --version
python -m csv_word_converter --list-templates
```

### 阶段3: 功能完整性测试

#### 测试内容
- [ ] 所有模板类型转换测试
- [ ] 边界条件和异常处理测试
- [ ] 性能基准测试
- [ ] 多文件批处理测试

#### 验收标准
- ✅ 5种模板(guoziwei, new_energy, realty, technology, electricity)均可正常使用
- ✅ 空CSV、大文件CSV、特殊字符CSV处理正常
- ✅ 单个文件转换时间 < 30秒(标准测试文件)
- ✅ 内存使用 < 500MB(标准测试文件)
- ✅ 错误处理友好，提供清晰的错误信息

#### 测试用例
```powershell
# 基础功能测试
python -m csv_word_converter demo_input.csv --template guoziwei
python -m csv_word_converter demo_input.csv --template new_energy --verbose

# 边界条件测试
python -m csv_word_converter empty.csv --template guoziwei
python -m csv_word_converter large_file.csv --template technology
```

### 阶段4: 生产环境模拟测试

#### 测试内容
- [ ] 无开发工具环境测试
- [ ] 网络受限环境测试
- [ ] 权限受限环境测试
- [ ] 长时间运行稳定性测试

#### 验收标准
- ✅ 在无Git、无开发工具的环境中正常运行
- ✅ 离线环境中(已安装依赖)正常工作
- [ ] 普通用户权限下正常运行
- ✅ 连续运行24小时无内存泄漏

### 阶段5: 兼容性测试

#### 测试内容
- [ ] Python多版本兼容性
- [ ] 操作系统兼容性
- [ ] 依赖版本兼容性

#### 验收标准
- ✅ Python 3.8-3.12 全版本支持
- ✅ Windows 10/11 完全支持
- [ ] Linux Ubuntu 20.04+ 基础支持
- ✅ 核心依赖包版本范围合理

## 测试数据准备

### 标准测试文件
1. **demo_input.csv**: 基础功能测试(已存在)
2. **empty.csv**: 空文件测试
3. **large_file.csv**: 大文件测试(1000+行)
4. **special_chars.csv**: 特殊字符测试
5. **unicode_test.csv**: 中文编码测试

### 预期输出验证
- 生成的Word文档能正常打开
- 文档格式符合模板要求
- 文档内容与CSV数据一致
- 文档大小合理(< 10MB for 标准测试)

## 性能基准

### 响应时间基准
- 小文件(< 100行): < 5秒
- 中等文件(100-500行): < 15秒
- 大文件(500-1000行): < 30秒

### 资源使用基准
- 内存峰值: < 500MB
- 临时文件: 转换完成后自动清理
- CPU使用: 转换期间 < 80%

## 风险评估与缓解

### 高风险项
1. **依赖冲突**: 某些依赖包版本不兼容
   - 缓解: 在pyproject.toml中明确版本范围
   - 验证: 多环境测试

2. **大文件处理**: 内存溢出或处理超时
   - 缓解: 实现流式处理和进度显示
   - 验证: 大文件压力测试

3. **编码问题**: 特殊字符或中文处理异常
   - 缓解: 统一UTF-8编码处理
   - 验证: 多语言测试用例

### 中风险项
1. **模板文件缺失**: 部分模板文件未正确打包
   - 缓解: 检查MANIFEST.in配置
   - 验证: 包内容检查

2. **权限问题**: 临时文件创建权限不足
   - 缓解: 使用用户临时目录
   - 验证: 受限权限环境测试

## 测试报告要求

### 必须包含内容
1. **测试执行摘要**: 通过/失败统计
2. **环境信息**: Python版本、OS版本、依赖版本
3. **性能数据**: 响应时间、内存使用、文件大小
4. **问题清单**: 发现的bug和解决方案
5. **部署建议**: 生产环境部署注意事项

### 交付物清单
- [ ] 测试执行日志
- [ ] 性能基准报告
- [ ] 兼容性矩阵
- [ ] 部署指南文档
- [ ] 问题修复记录

## 测试时间安排

- **阶段1-2**: 2小时 (打包构建 + 安装测试)
- **阶段3**: 1小时 (功能完整性测试)
- **阶段4**: 1小时 (生产环境模拟)
- **阶段5**: 1小时 (兼容性测试)
- **报告整理**: 0.5小时

**总计**: 约5.5小时

## 成功标准

项目通过部署测试的最低要求：
1. ✅ 所有高优先级测试用例通过
2. ✅ 核心功能在目标环境中正常工作
3. ✅ 性能指标满足基准要求
4. ✅ 无阻塞性bug或安全问题
5. ✅ 文档和安装说明完整准确

达到以上标准即可认为项目已准备好进行生产部署。